This codes has a lot of bugs 